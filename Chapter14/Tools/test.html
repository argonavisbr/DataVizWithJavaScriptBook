<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>
<script>
    const source1 = '../Data/world.geojson';
    const source2 = '../Data/un_regions.csv';
    const target = '../Data/world-continents.geojson';

    Promise.all([
        d3.json(source1),
        d3.csv(source2, function(row) {
            return {
                continent: row.Continent,
                code: row.Code
            };
        })
    ]).then(([world, regions]) => {
        const newData = [];
        const nothing = [];
        const matches = [];

    console.log(regions)

        world.features.forEach(function(c) {
            let match = false;
            regions.forEach(function(r) {
                if (r.code === c.id) {
                    match = true;
                    c.properties.continent = r.continent;
                    newData.push(r.Country);
                }
            });
            if(!match) {
                matches.push(c.id);
                c.properties.continent = 'Unmatched'
            }
        });

        console.log("NO MATCHES", matches);
        console.log("NEWDATA", newData.length);

        console.log(JSON.stringify(world));
    });
</script>
</body>
</html>