<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://unpkg.com/d3-tile"></script>
</head>
<body>
<script>

    const width = 960;
    const height = 500;

    const tileSize = 256;

    const svg = d3.select("body").append("svg")
            .attr("width", width).attr("height", height);

    const tileCanvas = svg.append("g").attr("class", "tiles");

    const z = 3; // change to zoom (openstreetmap: 0-19)

    drawTiles();

    function tileUrl(d) {
        const subdomain = ["a","b","c"][Math.random() * 3 | 0];
        const url = `http://${subdomain}.tile.openstreetmap.org/${d.z}/${d.x}/${d.y}.png`;
        console.log(url)
        return url;
    }

    function drawTiles() {

        const scale0 = 1 << z; // Same as Math.pow(2,z);
        const trans0 = scale0/2;

        const tile = d3.tile()
                .wrap(false)
                .scale(scale0 * tileSize)
                .translate([trans0 * tileSize, trans0 * tileSize])
                .extent([[0,0],[width, height]]);

        const tiles = tile();

        console.log(tiles)

        const tileCanvas = d3.select(".tiles");

        tileCanvas.selectAll("image")
            .data(tiles)
            .enter()
            .append("image")
            .attr("xlink:href", tileUrl)
            .attr("width", tileSize)
            .attr("height", tileSize)
            .attr("x", d => d.tx)
            .attr("y", d => d.ty);
    }

    function matrix3d(scale, translate) {
        var k = scale / tileSize, r = scale % 1 ? Number : Math.round;
        return "matrix3d(" + [k, 0, 0, 0, 0, k, 0, 0, 0, 0, k, 0, r(translate[0] * scale), r(translate[1] * scale), 0, 1 ] + ")";
    }

</script>
</body>
</html>